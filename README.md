# schrodinger-propagator

A C++ playground for propagating a 1D wavefunction in the Morse potential using
Taylor-series time stepping. The project generates static Morse potential data,
propagates a Gaussian wave packet, and ships a set of Python utilities for
post-processing the CSV logs.

## Build

### Prerequisites

* CMake 3.15+
* A C++17 compiler (GCC, Clang, or MSVC)
* Eigen 3.3+: either installed system-wide (`find_package(Eigen3)`) or available
  in `third_party/eigen-5.0.0`
* Optional: Python 3 with `numpy`, `pandas`, and `matplotlib` for the plotting
  scripts

### Configure & build

```bash
cmake -S . -B build -DCMAKE_BUILD_TYPE=Release
cmake --build build --config Release
```

The binary is produced as `build/morse` (`morse.exe` on Windows).

### Tests

A lightweight runtime smoke test is registered with CTest:

```bash
cmake --build build --target test
# or
ctest --test-dir build
```

The test runs the solver on a coarse grid with a short time window to catch
regressions in the build and logging pipeline.

## Usage

Generate static Morse data (potentials, eigenvalues/eigenvectors) and run the
Taylor propagator:

```bash
./build/morse --gamma 10 --N 2001 --xmax 30 \
              --evolve taylor --dt 1e-5 --tmax 1e-3 \
              --log 5000 --outdir results
```

Key flags:

* `--gamma`, `--N`, `--xmax` – Morse potential parameters and grid size
* `--evolve taylor` – enable Taylor propagation
* `--dt`, `--tmax`, `--K` – time step, total propagation time, and Taylor order
* `--log` – log cadence (number of steps between log rows)
* `--csv` – override the autogenerated log filename
* `--no_wide` – disable wide state dumps (`*_abs2_wide.csv`)
* `--wide-re`, `--wide-im` – additionally store Re/Im components alongside `|ψ|²`
* `--no-log-p0`, `--no-log-err` – trim optional columns from the Taylor CSV
* `--quiet` – suppress console output while still writing files

All results are written to `results/` by default. Wide CSV files store time rows
with the inner-grid coordinates as column names, simplifying downstream
post-processing.

## Python tooling

The `scripts/` directory contains utilities for plotting norms, errors, and
`|ψ|²` heatmaps. Example invocations:

```bash
python scripts/plot_taylor.py --glob "results/taylor_K*_dt*.csv" --split_by_K
python scripts/plot_psi_wide.py --glob "results/*_abs2_wide.csv"
python scripts/check_abs2_wide.py
```

Install Python dependencies via:

```bash
pip install -r requirements.txt
```

(If no `requirements.txt` is present, install `numpy`, `pandas`, and
`matplotlib` manually.)

## Continuous integration

The project is CI-friendly: the default configuration is warning-clean (`-Wall
-Wextra -Wpedantic` on GCC/Clang, `/W4` on MSVC) and ships a smoke test. A
minimal GitHub Actions workflow can configure the project, build it, and run
`ctest` on Linux, macOS, and Windows using the system Eigen package.

## Data hygiene

`results/` and `figures/` are tracked via `.gitignore` to keep heavy artefacts
out of version control. To keep the directories in the tree, lightweight
`.gitkeep` files are provided.
